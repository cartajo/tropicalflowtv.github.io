<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tropical Flow TV📺Radio - VIP</title>
<meta name="description" content="Acceso exclusivo a Tropical Flow TV📺Radio. Música, videos y más 24/7.">
<style>
  :root{
    --accent:#00e0ff; --bg:rgba(0,0,0,.6); --maxw:1100px;
    --aspect21x9:42.857%;
  }
  *{box-sizing:border-box}
  body{
    margin:0;font-family:Arial,Helvetica,sans-serif;color:#fff;
    background:linear-gradient(rgba(0,0,0,.5), rgba(0,0,0,.7)),
      url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1920&auto=format&fit=crop') center/cover fixed no-repeat;
  }
  header{ text-align:center; padding:1rem; background:rgba(0,0,0,.6) }
  h1{ margin:0; font-size:clamp(22px,3.2vw,34px) }
  .wrap{max-width:var(--maxw);margin:0 auto;padding:16px;background:var(--bg);border-radius:14px}
  section{margin:22px 0;padding:16px;background:rgba(255,255,255,.08);border-radius:12px}
  h2{margin:0 0 12px;text-align:center}
  audio{ width:100%; display:block; margin:8px auto; border-radius:10px }

  /* Video 21:9 */
  .video-shell{ width:100%; margin:0 auto; border-radius:12px; overflow:hidden; background:#000; max-width:var(--maxw) }
  .video-aspect{ position:relative; width:100%; padding-top:var(--aspect21x9) }
  .video-aspect > div, .video-aspect iframe{ position:absolute; inset:0; width:100%!important; height:100%!important }
  .fade{ transition:opacity .25s ease } .hide{opacity:0} .show{opacity:1}

  /* Thumbs */
  #yt-thumbs{ display:flex;gap:10px;overflow-x:auto;padding:12px;margin:6px auto 0;max-width:var(--maxw) }
  #yt-thumbs img{ height:90px;border-radius:10px;display:block }
  @media (max-width:600px){ #yt-thumbs img{ height:70px } }

  /* Botones */
  .btn{ background:var(--accent); color:#000; font-weight:700; border:none; border-radius:10px; padding:10px 14px; cursor:pointer }
  .btn.alt{ background:#2dd4bf }
  .btn.warn{ background:#fbbf24; color:#000 } /* amarillo con texto negro */

  /* Playlist */
  ul.plist{ list-style:none; padding:0; max-width:var(--maxw); margin:0 auto; color:#fff }
  ul.plist li{ padding:8px 10px; border-radius:8px; cursor:pointer }
  ul.plist li:hover{ background:rgba(255,255,255,.18) }
  .status{max-width:var(--maxw);margin:6px auto 0; font-size:.92rem}
  .ok{color:#7CFC00} .warn{color:#ffd166}

  /* Badge sobre el player */
  .badge{
    position:absolute; left:10px; bottom:10px; background:rgba(0,0,0,.55);
    padding:.35rem .6rem; border-radius:8px; font-weight:700; backdrop-filter: blur(2px);
  }

  .social-buttons{ text-align:center; margin: 16px 0 }
  .social-buttons a{ display:inline-block; margin:.4rem; padding:.6rem 1rem; color:#fff; text-decoration:none; border-radius:8px; background:#444 }
  .whatsapp{ background:#25d366 } .youtube{ background:#FF0000 } .facebook{ background:#3b5998 }
  .paypal{ background:#0070ba } .athmovil{ background:#6f42c1 }

  footer{ text-align:center; padding:1rem; background:rgba(0,0,0,.6); color:#ccc }
</style>
<!-- API YouTube -->
<script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
<header><h1>🌴 Tropical Flow TV📺Radio - VIP</h1></header>

<div class="wrap">
<!-- ========= RADIO Listen2MyRadio (versión con handlers inline) ========= -->
<section id="radio" style="margin-bottom:22px; position:relative; z-index:5">
  <h2 style="text-align:center;margin:0 0 10px">🎧 Tropical Flow TV📺 Radio</h2>

  <div id="radioCard" style="
      max-width:1100px;margin:0 auto;padding:16px;border-radius:14px;
      background:linear-gradient(135deg,rgba(15,23,42,.9),rgba(2,6,23,.92));
      border:1px solid rgba(255,255,255,.08); position:relative;">
    <div style="display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:56px;height:56px;border-radius:12px;background:#0ea5e9;display:flex;align-items:center;justify-content:center;font-weight:900">TF</div>
        <div>
          <div style="font-weight:900;font-size:20px;letter-spacing:.3px">Tropical Flow TV📺 Radio</div>
          <div style="opacity:.85">Salsa • Merengue • Bachata • Reggaetón 24/7</div>
          <div id="radioStatus" style="font-size:.9rem;opacity:.95;margin-top:4px;color:#A7F3D0">Listo para iniciar.</div>
        </div>
      </div>

      <div style="display:flex;gap:10px;flex-wrap:wrap; z-index:10">
        <button type="button" onclick="TF.start()"  style="background:#22d3ee;color:#000;border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer">▶ Empezar Radio</button>
        <button id="btnPause" type="button" onclick="TF.pause()" style="background:#334155;color:#fff;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer" disabled>⏸ Pausar</button>
        <button type="button" onclick="TF.retry()" style="background:#334155;color:#fff;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer">🔁 Reintentar</button>
        <button type="button" onclick="TF.swap()"  style="background:#334155;color:#fff;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer">🔀 Cambiar respaldo</button>
        <button type="button" onclick="TF.open()"  style="background:#fbbf24;color:#000;border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer">🌐 Abrir en pestaña</button>
      </div>
    </div>

    <audio id="radioAudio" preload="none" style="width:100%;margin-top:12px;display:none" controls></audio>

    <div id="httpsWarning" style="display:none;margin-top:10px;padding:10px;border-radius:10px;background:#7c2d12;color:#fff">
      ⚠ Esta página está en <b>HTTPS</b> y el stream es <b>HTTP</b>. Muchos navegadores bloquean el audio incrustado.
      Usa <b>“Abrir en pestaña”</b> o consigue una URL HTTPS del proveedor.
    </div>
  </div>
</section>

<script>
/* ====== Player global (TF) – handlers inline garantizan que los botones respondan ====== */
window.TF = (() => {
  // Datos de tu servidor (tus capturas)
  const HOST = "uk25freenew.listen2myradio.com";
  const PORT = 32403;

  // Candidatos de Shoutcast / Icecast
  const STREAMS = [
    http://${HOST}:${PORT}/stream,
    http://${HOST}:${PORT}/;stream.mp3,
    http://${HOST}:${PORT}/;,
    http://${HOST}:${PORT}/1
  ];
  const PUBLIC_PAGE = "http://tropicalflowtv.radio12345.com/";

  const elAudio  = document.getElementById("radioAudio");
  const statusEl = document.getElementById("radioStatus");
  const btnPause = document.getElementById("btnPause");
  const httpsWarn= document.getElementById("httpsWarning");

  if (location.protocol === "https:" && STREAMS.some(u=>u.startsWith("http://"))) {
    httpsWarn.style.display = "block";
  }

  let i = 0, trying = false;

  function setStatus(t, ok=true){ statusEl.textContent=t; statusEl.style.color = ok ? "#A7F3D0" : "#FFD166"; }
  function showBar(on){ elAudio.style.display = on ? "block" : "none"; btnPause.disabled = !on; }
  function pauseOthers(){ try{ if (typeof pauseAllExcept==='function') pauseAllExcept('radio'); }catch(_){} }

  async function tryPlay(idx){
    i = (idx + STREAMS.length) % STREAMS.length;
    const url = STREAMS[i];
    setStatus("Conectando: "+url+" …");
    elAudio.src = url; elAudio.crossOrigin = "anonymous"; elAudio.load();
    pauseOthers();
    try {
      const p = elAudio.play();
      await Promise.race([p, new Promise((_,r)=>setTimeout(()=>r(new Error("timeout")),6000))]);
      setStatus("✅ Reproduciendo.");
      showBar(true);
      if ('mediaSession' in navigator){
        try{
          navigator.mediaSession.metadata = new MediaMetadata({
            title:"Tropical Flow TV Radio",
            artist:"24/7 Salsa • Merengue • Bachata • Reggaetón",
            album:"Live"
          });
        }catch(_){}
      }
      return true;
    } catch(e){ return false; }
  }

  async function start(){
    if (trying) return;
    trying = true;
    showBar(false);
    for (let k=0;k<STREAMS.length;k++){
      if (await tryPlay(i+k)){ trying=false; return; }
    }
    trying=false;
    setStatus("⚠ No se pudo conectar. Revisa AutoDJ/encoder o usa “Abrir en pestaña”.", false);
  }

  function pause(){ elAudio.pause(); setStatus("En pausa. Pulsa ▶ para continuar."); }
  function retry(){ elAudio.pause(); showBar(false); start(); }
  function swap(){ i=(i+1)%STREAMS.length; setStatus("Respaldo seleccionado. Pulsa ▶."); if(!elAudio.paused) tryPlay(i); }
  function open(){ window.open(PUBLIC_PAGE,"_blank"); }

  elAudio.addEventListener('play',  ()=>{ showBar(true); setStatus("✅ Reproduciendo."); });
  elAudio.addEventListener('pause', ()=>{ setStatus("En pausa. Pulsa ▶ para continuar."); });
  elAudio.addEventListener('error', ()=>{ setStatus("Error de reproducción. Probando otra ruta…", false); tryPlay(i+1); });

  return { start, pause, retry, swap, open };
})();
</script>
  <!-- ============ VIDEOS RECIENTES (Carrusel) ============ -->
  <section id="videos">
    <h2>🎬 Videos Recientes</h2>
    <div class="video-shell"><div class="video-aspect">
      <div id="yt-carousel-player" class="fade show"></div>
    </div></div>
    <div id="yt-current-title" style="max-width:var(--maxw);margin:10px auto 0;text-align:center;font-weight:700;"></div>
    <div style="max-width:var(--maxw);margin:10px auto 0;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
      <button id="btnPrevVid" class="btn">⏮ Anterior</button>
      <button id="btnPlayPauseVid" class="btn alt">▶ / ⏸</button>
      <button id="btnNextVid" class="btn">⏭ Siguiente</button>
      <button id="btnFs" class="btn warn">⤢ Pantalla completa</button>
    </div>
    <div id="yt-thumbs"></div>
  </section>

   <!-- ===================== PLAYLIST VIP 1 (lee /musica/) ===================== -->
    <section class="playlist-box">
      <h2>🎶 Playlist VIP 1</h2>

      <audio id="audio1" controls style="width:100%;max-width:720px;display:block;margin:8px auto;" preload="metadata">
        Tu navegador no soporta audio HTML5.
      </audio>

      <div style="text-align:center;margin:10px 0;">
        <button id="prev1" class="btn">⏮ Anterior</button>
        <button id="play1" class="btn">▶ / ⏸</button>
        <button id="next1" class="btn">⏭ Siguiente</button>
      </div>

      <ul id="list1" class="plist"></ul>
      <div id="status1" class="status"></div>

      <script>
        // RUTA base a tus MP3
        const base1 = "../musica/"; // <- están fuera de /Privado/ en /musica/

        // TUS 10 TEMAS con nombres LIMPIOS (renómbralos así al subir a /musica/)
        const raw1 = [
          { title: "01 - Aquí Estoy Yo [Urban Remix] - Luis Fonsi & Yomo.mp3", file: "01 - Aquí Estoy Yo [Urban Remix] - Luis Fonsi & Yomo.mp3" },
          { title: "02 - dj mario andretti - mix merengue romantico.mp3",     file: "02 - dj mario andretti - mix merengue romantico.mp3" },
          { title: "03 - La Amas Como Yo - Karis.Mp3",                         file: "03 - La Amas Como Yo - Karis.Mp3" },
          { title: "04 - Que Voy A Hacer Sin Ti - Grupo Caneo.Mp3",                            file: "04 - Que Voy A Hacer Sin Ti - Grupo Caneo.Mp3" },
          { title: "05 - Hey Dude! - Elvis Crespo.mp3",            file: "05 - Hey Dude! - Elvis Crespo.mp3" },
          { title: "06 - Te Regalo Amores - Ken-Yrkm.mp3",                            file: "06 - Te Regalo Amores - Ken-Yrkm.mp3" },
          { title: "07 - What Is Love - Haddaway.Mp3",                  file: "08 - What Is Love - Haddaway.Mp3" },
          { title: "08 - Boricua Como El Gran Combo.mp3",     file: "09 - Boricua Como El Gran Combo.mp3" },
          { title: "09 - Me Gusta, Me Gusta - Elvis Crespo.mp3",                           file: "10 - Me Gusta, Me Gusta - Elvis Crespo.mp3" },
          { title: "10 - Alexis & Fido Ft Daddy Yankee - Rescate.mp3",                                 file: "10 - Alexis & Fido Ft Daddy Yankee - Rescate.mp3" }
        ];

        const t1 = raw1.map(t => ({ title: t.title, src: base1 + encodeURIComponent(t.file) }));

        const A1 = {
          audio:  document.getElementById('audio1'),
          list:   document.getElementById('list1'),
          prev:   document.getElementById('prev1'),
          play:   document.getElementById('play1'),
          next:   document.getElementById('next1'),
          status: document.getElementById('status1'),
          i: 0
        };

        function s1(msg, cls="ok"){ A1.status.className="status "+cls; A1.status.textContent=msg; }

        function render1(){
          A1.list.innerHTML = "";
          t1.forEach((it, idx)=>{
            const li = document.createElement('li');
            li.textContent = (idx===A1.i ? "▶ " : "") + it.title;
            li.style.padding="8px 10px"; li.style.borderRadius="8px"; li.style.cursor="pointer";
            li.style.background = idx===A1.i ? "rgba(0,191,255,.35)" : "transparent";
            li.onclick = () => { A1.i = idx; load1(true); };
            A1.list.appendChild(li);
          });
        }

        function load1(autoplay){
          A1.audio.src = t1[A1.i].src;
          render1();
          s1("Cargando: "+t1[A1.i].title+"…","ok");
          if (autoplay) A1.audio.play().catch(()=>{});
        }

        A1.prev.onclick = ()=>{ A1.i = (A1.i - 1 + t1.length) % t1.length; load1(true); };
        A1.next.onclick = ()=>{ A1.i = (A1.i + 1) % t1.length; load1(true); };
        A1.play.onclick = ()=>{ if (A1.audio.paused) A1.audio.play().catch(()=>{}); else A1.audio.pause(); };

        A1.audio.addEventListener('ended', ()=>{ A1.i = (A1.i + 1) % t1.length; load1(true); });
        A1.audio.addEventListener('loadedmetadata', ()=> s1("Listo: "+t1[A1.i].title+" ✓","ok"));
        A1.audio.addEventListener('error', ()=> s1("⚠ No se pudo cargar: "+decodeURIComponent(t1[A1.i].src)+" (¿/musica/ y nombre correcto?)","warn"));

        load1(false);
      </script>
     
     
    <!-- =================== FIN PLAYLIST VIP 1 =================== -->


  <!-- ============ VIDEO PROMO secuencial ============ -->
  <section id="promo" style="margin-top:24px;">


  <!-- ============ VIDEO PROMO ============ -->
  <section id="promo" style="margin-top:24px;">
    <h2>🎬 Video Promo Tropical</h2>
    <div class="video-shell"><div class="video-aspect">
      <div id="promo-player" class="fade show"></div>
    </div></div>
    <div style="max-width:var(--maxw);margin:10px auto 0;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
      <button id="promoPrev" class="btn">⏮ Anterior</button>
      <button id="promoPlay" class="btn alt">▶ / ⏸</button>
      <button id="promoNext" class="btn">⏭ Siguiente</button>
      <button id="promoFs"   class="btn warn">⤢ Pantalla completa</button>
    </div>
    <div id="promo-title" style="max-width:var(--maxw);margin:8px auto 0;text-align:center;font-weight:700;"></div>
  </section>

  <!-- ============ BOTONES SOCIALES ============ -->
  <div class="social-buttons">
    <a class="whatsapp" href="https://wa.me/19399029695" target="_blank">WhatsApp</a>
    <a class="youtube" href="https://www.youtube.com/@TFTvpoweredbyworldm8780" target="_blank">YouTube</a>
    <a class="facebook" href="https://www.facebook.com/profile.php?id=61555653663073" target="_blank">Facebook</a>
    <a class="paypal" href="https://www.paypal.com/donate/?business=cartajoffice1@gmail.com&currency_code=USD" target="_blank">🎧 Donar vía PayPal</a>
    <a class="athmovil" href="https://www.athmovil.com/cartajo" target="_blank">Donar ATH Móvil</a>
  </div>
</div>

<footer>&copy; <span id="year"></span> Tropical Flow TV📺Radio - Todos los derechos reservados</footer>

<script>
  document.getElementById('year').textContent = new Date().getFullYear();
  setTimeout(()=>{ const box=document.getElementById('onlineBox');
    if(box && !box.textContent.trim()){ const n=Math.floor(Math.random()*40)+5; box.textContent="Conectados: "+n; }
  },2000);
</script>

<script>
/* ===== Control central: pausar el resto ===== */
const registry = {
  radio: () => document.getElementById('radioFallback'),
  playlist: () => document.getElementById('audio1'),
  yt: () => window._ytCarouselPlayerInstance,
  promo: () => window._ytPromoPlayerInstance
};
function pauseAllExcept(source){
  try{
    if (source!=='radio'){ const r = registry.radio(); r && !r.paused && r.pause(); }
    if (source!=='playlist'){ const p = registry.playlist(); p && !p.paused && p.pause(); }
    if (source!=='yt'){
      const y = registry.yt && registry.yt();
      if (y && y.getPlayerState && y.getPlayerState() === YT.PlayerState.PLAYING) y.pauseVideo();
    }
    if (source!=='promo'){
      const pr = registry.promo && registry.promo();
      if (pr && pr.getPlayerState && pr.getPlayerState() === YT.PlayerState.PLAYING) pr.pauseVideo();
    }
  }catch(e){}
}
</script>

<script>
/* ===== RADIO: Caster + Fallback ===== */
(function(){
  const PUBLIC_TOKEN = "173d1740-5216-4cbe-8e2b-cb45338d9e19"; // tu token
  const EMBED_SRC = "https://cdn.cloud.caster.fm/widgets/embed.js";

  const cont   = document.getElementById("casterContainer");
  const aBack  = document.getElementById("radioFallback");
  const status = document.getElementById("casterStatus");

  const btnRetry   = document.getElementById("radioRetry");
  const btnOpen    = document.getElementById("radioOpen");
  const btnOfficial= document.getElementById("forceOfficial");
  const btnFallback= document.getElementById("forceFallback");
  const btnChange  = document.getElementById("changeBackup");

  // Streams de respaldo (pon los tuyos de merengue/bachata/reggaetón)
  const BACKUPS = [
    "https://stream-149.zeno.fm/0cn4d1x2kxhvv?zs=Q3nXn5nPTT",
    "https://stream-40.zeno.fm/8s5yq7g7p0hvv?zs=Jw9C4S1hQp",
    "https://stream-61.zeno.fm/9x4n4v2t9uhvv?zs=1h2kJc" // ejemplo extra
  ];
  let backupIndex = 0;
  function setBackup(i){
    backupIndex = (i + BACKUPS.length) % BACKUPS.length;
    aBack.src = BACKUPS[backupIndex];
  }
  setBackup(0);

  let forced = null; // 'official' | 'fallback' | null

  function mountCaster(){
    cont.innerHTML = `
      <div data-type="newStreamPlayer" data-publicToken="${PUBLIC_TOKEN}"
           data-theme="dark" data-color="e81e4d" class="cstrEmbed"
           style="min-height:360px">
        <!-- Enlaces obligatorios de Caster.fm -->
        <a href="https://www.caster.fm">Shoutcast Hosting</a>
        <a href="https://www.caster.fm">Stream Hosting</a>
        <a href="https://www.caster.fm">Radio Server Hosting</a>
      </div>
      <span class="badge">Tropical Flow TV Radio</span>
    `;
    const s = document.createElement("script");
    s.src = EMBED_SRC + "?t=" + Date.now(); // recarga forzada
    s.async = true;
    cont.appendChild(s);
    status.textContent = "Cargando reproductor oficial…";
  }

  function useFallback(autoMsg){
    forced = forced || null;
    aBack.style.display = "";
    pauseAllExcept('radio');
    aBack.play().catch(()=>{});
    status.textContent = autoMsg || "Usando respaldo HTML5.";
  }
  function useOfficial(){
    aBack.pause();
    aBack.style.display = "none";
    status.textContent = "Usando reproductor oficial de Caster.fm.";
  }

  function autoDetect(){
    if (forced === 'fallback'){ return useFallback("Forzado a respaldo."); }
    if (forced === 'official'){ return useOfficial(); }

    setTimeout(()=>{
      const embed = document.querySelector('.cstrEmbed');
      const rendered = embed?.getAttribute('data-rendered') === 'true' || document.getElementById('cstrpdiv');
      if (!rendered) return useFallback("El widget no cargó. Respaldo automático.");
      const holder = document.querySelector('.cstrEmbed, #cstrpdiv');
      const txt = (holder?.innerText || "").toLowerCase();
      if (txt.includes("broadcast is currently offline")){
        useFallback("Servidor sin transmisión. Usando respaldo hasta que conectes el encoder.");
      } else {
        useOfficial();
      }
    }, 6000);
  }

  btnRetry.onclick    = ()=>{ mountCaster(); autoDetect(); };
  btnOpen.onclick     = ()=> window.open("https://tropicalflowradio.ismyradio.com", "_blank");
  btnOfficial.onclick = ()=>{ forced='official'; useOfficial(); };
  btnFallback.onclick = ()=>{ forced='fallback'; useFallback(); };
  btnChange.onclick   = ()=>{ setBackup(backupIndex+1); useFallback("Cambiado respaldo."); };

  aBack.addEventListener('play', ()=> pauseAllExcept('radio'));

  mountCaster();
  autoDetect();
})();
</script>

<script>
/* ===== CARRUSEL YouTube ===== */
const CAROUSEL_IDS = [
  "tpi8zLE3Kqw","RBE8A9rAj8Y","XYe0ZHVvVig","h86xW_G-j4s","5pKPlIlQa_8",
  "wgqGHqhEZ8M","auTHP2prrxw","CL7m60BISiw","4jdbpZVzlf4","X_Df1rsXBjE",
  "RWp76Pj0RUo","M9wQdkQicbk","FCu8-sim5F4","O6xVXaBcOac","jTqKxMTtVEI",
  "4tXLT0hN8n8","n8RMGnc8v_o"
];
let cIndex = 0, cPlayer = null;

function buildThumbs(){
  const strip = document.getElementById("yt-thumbs");
  strip.innerHTML = CAROUSEL_IDS.map((id,idx)=>`
    <button data-i="${idx}" style="border:0;background:transparent;cursor:pointer;flex:0 0 auto">
      <img src="https://img.youtube.com/vi/${id}/hqdefault.jpg"
           alt="thumb ${idx+1}"
           style="height:90px;border-radius:10px;opacity:${idx===cIndex?1:.55};
                  outline:${idx===cIndex?'3px solid #00e0ff':'none'}">
    </button>`).join("");
  strip.querySelectorAll("button").forEach(btn=>btn.onclick = ()=> goTo(+btn.dataset.i));
}
function highlight(){
  document.querySelectorAll("#yt-thumbs img").forEach((img,idx)=>{
    img.style.opacity = (idx===cIndex? "1" : ".55");
    img.style.outline = (idx===cIndex? "3px solid #00e0ff" : "none");
  });
}
function updateTitleSoon(){ setTimeout(()=>{
  try{ const d = cPlayer.getVideoData(); document.getElementById("yt-current-title").textContent = d?.title || ""; }catch(_){}
}, 300);}

function fadeSwap(loadFn){
  const box = document.getElementById('yt-carousel-player');
  box.classList.remove('show'); box.classList.add('hide');
  setTimeout(()=>{ loadFn(); box.classList.remove('hide'); box.classList.add('show'); }, 180);
}
function goTo(idx){
  cIndex = (idx + CAROUSEL_IDS.length) % CAROUSEL_IDS.length;
  pauseAllExcept('yt');
  if (cPlayer && cPlayer.loadVideoById) { fadeSwap(()=> cPlayer.loadVideoById(CAROUSEL_IDS[cIndex])); highlight(); updateTitleSoon(); }
  else { renderFallback(); }
}
function prevVideo(){ goTo(cIndex - 1); }
function nextVideo(){ goTo(cIndex + 1); }
function togglePlay(){
  try{
    const s = cPlayer.getPlayerState();
    if (s === YT.PlayerState.PLAYING) cPlayer.pauseVideo();
    else { pauseAllExcept('yt'); cPlayer.playVideo(); }
  }catch(_){}
}
function renderFallback(){
  const box = document.getElementById('yt-carousel-player');
  box.innerHTML = `<iframe src="https://www.youtube.com/embed/${CAROUSEL_IDS[cIndex]}?rel=0&modestbranding=1&playsinline=1"
                       title="YouTube video" frameborder="0"
                       allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                       allowfullscreen></iframe>`;
  document.getElementById("yt-current-title").textContent = "";
  buildThumbs(); highlight();
  document.getElementById("btnPrevVid").onclick = prevVideo;
  document.getElementById("btnNextVid").onclick = nextVideo;
  document.getElementById("btnPlayPauseVid").onclick = ()=>{};
  document.getElementById("btnFs").onclick = ()=>{
    const shell = document.querySelector('#videos .video-shell');
    if (document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.();
  };
}
function createCarouselPlayer(){
  if (!(window.YT && window.YT.Player)) { renderFallback(); return; }
  cPlayer = new YT.Player('yt-carousel-player', {
    videoId: CAROUSEL_IDS[cIndex],
    playerVars: { rel:0, modestbranding:1, playsinline:1, controls:1 },
    events: {
      onReady: e => { try{ e.target.mute(); e.target.playVideo(); }catch(_){} updateTitleSoon(); },
      onStateChange: e => {
        if (e.data === YT.PlayerState.PLAYING) pauseAllExcept('yt');
        if (e.data === YT.PlayerState.ENDED) nextVideo();
        if (e.data === YT.PlayerState.PLAYING || e.data === YT.PlayerState.CUED) updateTitleSoon();
      }
    }
  });
  window._ytCarouselPlayerInstance = cPlayer;
  buildThumbs(); highlight();
  document.getElementById("btnPrevVid").onclick = prevVideo;
  document.getElementById("btnNextVid").onclick = nextVideo;
  document.getElementById("btnPlayPauseVid").onclick = togglePlay;

  const btn = document.getElementById('btnFs');
  const shell = document.querySelector('#videos .video-shell');
  function toggleFs(){ if (document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.(); }
  function onFsChange(){ btn.textContent = document.fullscreenElement ? "⤢ Salir de pantalla completa" : "⤢ Pantalla completa"; }
  btn?.addEventListener('click', toggleFs);
  document.addEventListener('fullscreenchange', onFsChange);
}
(function initYT(){
  let started = false;
  function startOnce(){ if (started) return; started = true; createCarouselPlayer(); }
  if (window.YT && window.YT.Player) { startOnce(); }
  const prev = window.onYouTubeIframeAPIReady;
  window.onYouTubeIframeAPIReady = function(){ if (typeof prev==='function') prev(); startOnce(); };
  setTimeout(()=>{ if (!started) { renderFallback(); } }, 2000);
})();
</script>


       
<script>
/* ===== VIDEO PROMO (Merengue → Salsa) ===== */
const PROMO_IDS = ["U0V7ATX_2CY", "5ZVTbahB5CM"];
let promoIndex = 0, promoPlayer = null;

function promoPrev(){ promoIndex = (promoIndex - 1 + PROMO_IDS.length) % PROMO_IDS.length; pauseAllExcept('promo'); promoPlayer.loadVideoById(PROMO_IDS[promoIndex]); }
function promoNext(){ promoIndex = (promoIndex + 1) % PROMO_IDS.length; pauseAllExcept('promo'); promoPlayer.loadVideoById(PROMO_IDS[promoIndex]); }
function promoToggle(){
  try{
    const s = promoPlayer.getPlayerState();
    if (s === YT.PlayerState.PLAYING) promoPlayer.pauseVideo();
    else { pauseAllExcept('promo'); promoPlayer.playVideo(); }
  }catch(_){}
}
function createPromoPlayer(){
  if (!(window.YT && window.YT.Player)) return;
  promoPlayer = new YT.Player('promo-player', {
    videoId: PROMO_IDS[promoIndex],
    playerVars: { rel:0, modestbranding:1, playsinline:1, controls:1 },
    events: {
      onReady: e => { try{ e.target.mute(); e.target.playVideo(); }catch(_){ } setTimeout(updatePromoTitle,300); },
      onStateChange: e => {
        if (e.data === YT.PlayerState.PLAYING) pauseAllExcept('promo');
        if (e.data === YT.PlayerState.ENDED) promoNext();
        if (e.data === YT.PlayerState.PLAYING || e.data === YT.PlayerState.CUED) setTimeout(updatePromoTitle,300);
      }
    }
  });
  window._ytPromoPlayerInstance = promoPlayer;

  document.getElementById('promoPrev').onclick = promoPrev;
  document.getElementById('promoNext').onclick = promoNext;
  document.getElementById('promoPlay').onclick = promoToggle;

  const fsBtn = document.getElementById('promoFs');
  const shell = document.querySelector('#promo .video-shell');
  function toggleFs(){ if (document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.(); }
  function onFsChange(){ fsBtn.textContent = document.fullscreenElement ? "⤢ Salir de pantalla completa" : "⤢ Pantalla completa"; }
  fsBtn?.addEventListener('click', toggleFs);
  document.addEventListener('fullscreenchange', onFsChange);
}
function updatePromoTitle(){ try{ const d = promoPlayer.getVideoData(); document.getElementById('promo-title').textContent = d?.title || ""; }catch(_){} }

(function loadPromo(){
  if (window.YT && window.YT.Player) { createPromoPlayer(); return; }
  const prev = window.onYouTubeIframeAPIReady;
  window.onYouTubeIframeAPIReady = function(){ if (typeof prev==='function') prev(); createPromoPlayer(); };
})();
</script>

</body>
</html>
 
