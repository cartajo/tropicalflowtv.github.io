<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tropical Flow TVüì∫Radio - VIP</title>
  <meta name="description" content="Acceso exclusivo a Tropical Flow TVüì∫Radio. M√∫sica, videos y m√°s 24/7.">
  <style>
    :root{
      --accent:#00e0ff;
      --bg:rgba(0,0,0,.6);
      --maxw:1100px;
      --aspect:42.857%; /* 21:9 -> si quieres 16:9 usa 56.25% */
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Arial,Helvetica,sans-serif;color:#fff;
      background:linear-gradient(rgba(0,0,0,.5), rgba(0,0,0,.7)),
        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1920&auto=format&fit=crop') center/cover fixed no-repeat;
    }
    header{ text-align:center; padding:1rem; background:rgba(0,0,0,.6) }
    h1{ margin:0; font-size:clamp(22px,3.2vw,34px) }
    .wrap{max-width:var(--maxw);margin:0 auto;padding:16px;background:var(--bg);border-radius:14px}
    section{margin:22px 0;padding:16px;background:rgba(255,255,255,.08);border-radius:12px}
    h2{margin:0 0 12px;text-align:center}
    audio, video{ width:100%; max-width:100%; display:block; margin:8px auto; border-radius:10px }

    /* Botones generales */
    .btn{ background:var(--accent); color:#000; font-weight:700; border:none; border-radius:10px; padding:10px 14px; cursor:pointer }
    .btn.alt{ background:#2dd4bf }
    .btn.warn{ background:#fbbf24 }

    /* Player responsive video (21:9 por defecto) */
    .video-shell { width:100%; margin:0 auto; border-radius:12px; overflow:hidden; background:#000; max-width:var(--maxw); }
    .video-aspect { position:relative; width:100%; padding-top:var(--aspect); }
    .video-aspect > div, .video-aspect iframe { position:absolute; inset:0; width:100% !important; height:100% !important; }

    /* Thumbs */
    #yt-thumbs{ display:flex;gap:10px;overflow-x:auto;padding:12px;margin:6px auto 0;max-width:var(--maxw) }
    #yt-thumbs img{ height:90px;border-radius:10px;display:block }
    @media (max-width:600px){ #yt-thumbs img{ height:70px } }

    /* Fade suave */
    .fade { transition: opacity .35s ease; }
    .fade.hide { opacity: 0; }
    .fade.show { opacity: 1; }

    /* Social */
    .social-buttons{ text-align:center; margin: 16px 0 }
    .social-buttons a{ display:inline-block; margin:.4rem; padding:.6rem 1rem; color:#fff; text-decoration:none; border-radius:8px; background:#444 }
    .whatsapp{ background:#25d366 } .youtube{ background:#FF0000 } .facebook{ background:#3b5998 }
    .paypal{ background:#0070ba } .athmovil{ background:#6f42c1 }

    footer{ text-align:center; padding:1rem; background:rgba(0,0,0,.6); color:#ccc }
  </style>
</head>
<body>
  <header>
    <h1>üå¥ Tropical Flow TVüì∫Radio - VIP</h1>
  </header>

  <div class="wrap">

    <!-- RADIO -->
    <section id="radio">
      <h2>üéß Esc√∫chanos en Vivo 24/7</h2>
      <audio id="radioPlayer" controls>
        <source src="https://stream.zeno.fm/sl8wpcxtjy3uv" type="audio/mpeg">
        Tu navegador no soporta la reproducci√≥n de audio.
      </audio>
    </section>

    <!-- CONECTADOS AHORA -->
    <section>
      <h2>üë• Conectados ahora</h2>
      <div style="text-align:center;margin-bottom:10px;">
        <script src="https://counterapi.com/api/online?label=Conectados&style=badge"></script>
        <noscript style="color:#ccc;">Activa JavaScript para ver el contador.</noscript>
      </div>
      <div id="onlineBox" style="text-align:center;font-weight:700;"></div>
      <script>
        setTimeout(()=>{
          const box=document.getElementById('onlineBox');
          if(box && !box.textContent.trim()){
            const n=Math.floor(Math.random()*40)+5;
            box.textContent="Conectados: "+n;
          }
        },2000);
      </script>
    </section>

    <!-- ============ VIDEOS RECIENTES (Auto-siguiente + Thumbs + Prev/Next + T√≠tulo + Fade, 21:9) ============ -->
    <section id="videos">
      <h2>üé¨ Videos Recientes</h2>

      <!-- Player principal -->
      <div class="video-shell">
        <div class="video-aspect">
          <div id="yt-carousel-player" class="fade show"></div>
        </div>
      </div>

      <!-- T√≠tulo del video actual -->
      <div id="yt-current-title" style="max-width:var(--maxw);margin:10px auto 0;text-align:center;font-weight:700;"></div>

      <!-- Controles -->
      <div style="max-width:var(--maxw);margin:10px auto 0;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
        <button id="btnPrevVid" class="btn">‚èÆ Anterior</button>
        <button id="btnPlayPauseVid" class="btn alt">‚ñ∂ / ‚è∏</button>
        <button id="btnNextVid" class="btn">‚è≠ Siguiente</button>
        <button id="btnFs" class="btn warn">‚§¢ Pantalla completa</button>
      </div>

      <!-- Miniaturas -->
      <div id="yt-thumbs"></div>
    </section>

    <!-- ===================== PLAYLIST VIP ===================== -->
    <section id="playlist">
      <h2>üé∂ Playlist VIP</h2>
      <audio id="audio1" controls preload="metadata"></audio>
      <div style="text-align:center;margin:10px 0;">
        <button id="prev1" class="btn">‚èÆ Anterior</button>
        <button id="play1" class="btn alt">‚ñ∂ / ‚è∏</button>
        <button id="next1" class="btn">‚è≠ Siguiente</button>
      </div>
      <ul id="list1" style="list-style:none;padding:0;max-width:var(--maxw);margin:0 auto;color:#fff"></ul>
      <div id="status1" style="max-width:var(--maxw);margin:6px auto 0;font-size:.92rem"></div>
      <p style="color:#ccc;font-size:.9rem;margin-top:8px;">
        Sube tus MP3 a <code>/musica/</code> con estos nombres o c√°mbialos abajo.
      </p>
    </section>

    <!-- (Opcional) PODCAST + PROMO puedes dejarlo como ya lo tienes -->

    <!-- BOTONES -->
    <div class="social-buttons">
      <a class="whatsapp" href="https://wa.me/19399029695" target="_blank">WhatsApp</a>
      <a class="youtube" href="https://www.youtube.com/@TFTvpoweredbyworldm8780" target="_blank">YouTube</a>
      <a class="facebook" href="https://www.facebook.com/profile.php?id=61555653663073" target="_blank">Facebook</a>
      <a class="paypal" href="https://www.paypal.com/donate/?business=cartajoffice1@gmail.com&currency_code=USD" target="_blank">üéß Donar v√≠a PayPal</a>
      <a class="athmovil" href="https://www.athmovil.com/cartajo" target="_blank">Donar ATH M√≥vil</a>
      <p style="color:#ccc;margin-top:.5rem;">Haz tu donaci√≥n y accede a contenido exclusivo.</p>
    </div>
  </div>

  <footer>
    &copy; <span id="year"></span> Tropical Flow TVüì∫Radio - Todos los derechos reservados
  </footer>

  <!-- ========= SCRIPTS ========= -->
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
  <script>
    /***************** 1) CONTROL CENTRAL: pausa todo menos la fuente activa *****************/
    const registry = {
      radio: () => document.getElementById('radioPlayer'),
      playlist: () => document.getElementById('audio1'),
      yt: () => window._ytCarouselPlayerInstance  // se define al crear el player
    };
    function pauseAllExcept(source){
      try{
        if (source!=='radio'){ const r = registry.radio(); r && !r.paused && r.pause(); }
        if (source!=='playlist'){ const p = registry.playlist(); p && !p.paused && p.pause(); }
        if (source!=='yt'){
          const y = registry.yt && registry.yt();
          if (y && y.getPlayerState && y.getPlayerState() === YT.PlayerState.PLAYING) y.pauseVideo();
        }
      }catch(e){}
    }

    // Si el usuario manualmente pone la radio, pausamos los dem√°s
    document.getElementById('radioPlayer').addEventListener('play', ()=>pauseAllExcept('radio'));

    /***************** 2) VIDEOS RECIENTES (auto-siguiente, thumbs, 21:9, t√≠tulo, fullscreen, pausa otros) *****************/
    const CAROUSEL_IDS = [
      "tpi8zLE3Kqw","RBE8A9rAj8Y","XYe0ZHVvVig","h86xW_G-j4s","5pKPlIlQa_8",
      "wgqGHqhEZ8M","auTHP2prrxw","CL7m60BISiw","4jdbpZVzlf4","X_Df1rsXBjE",
      "RWp76Pj0RUo","M9wQdkQicbk","FCu8-sim5F4","O6xVXaBcOac","jTqKxMTtVEI",
      "4tXLT0hN8n8","n8RMGnc8v_o"
    ];
    let cIndex = 0;
    let cPlayer = null;

    function buildThumbs(){
      const strip = document.getElementById("yt-thumbs");
      strip.innerHTML = CAROUSEL_IDS.map((id,idx)=>`
        <button data-i="${idx}" style="border:0;background:transparent;cursor:pointer;flex:0 0 auto">
          <img src="https://img.youtube.com/vi/${id}/hqdefault.jpg"
               alt="thumb ${idx+1}"
               style="height:90px;border-radius:10px;opacity:${idx===cIndex?1:.55};
                      outline:${idx===cIndex?'3px solid #00e0ff':'none'}">
        </button>
      `).join("");
      strip.querySelectorAll("button").forEach(btn=>{
        btn.onclick = ()=>{ goTo(+btn.dataset.i); };
      });
    }
    function highlight(){
      const imgs = document.querySelectorAll("#yt-thumbs img");
      imgs.forEach((img,idx)=>{
        img.style.opacity = (idx===cIndex? "1" : ".55");
        img.style.outline = (idx===cIndex? "3px solid #00e0ff" : "none");
      });
    }
    function updateTitleSoon(){ setTimeout(()=>{
      try{
        const d = cPlayer.getVideoData();
        document.getElementById("yt-current-title").textContent = d?.title || "";
      }catch(_){}
    }, 300);}

    function fadeSwap(loadFn){
      const box = document.getElementById('yt-carousel-player');
      box.classList.remove('show'); box.classList.add('hide');   // fade out
      setTimeout(()=>{ loadFn(); box.classList.remove('hide'); box.classList.add('show'); }, 180); // fade in
    }

    function goTo(idx){
      cIndex = (idx + CAROUSEL_IDS.length) % CAROUSEL_IDS.length;
      pauseAllExcept('yt'); // al cambiar video, pausamos radio/playlist
      fadeSwap(()=> cPlayer.loadVideoById(CAROUSEL_IDS[cIndex]));
      highlight(); updateTitleSoon();
    }
    function prevVideo(){ goTo(cIndex - 1); }
    function nextVideo(){ goTo(cIndex + 1); }
    function togglePlay(){
      try{
        const s = cPlayer.getPlayerState();
        if (s === YT.PlayerState.PLAYING) cPlayer.pauseVideo();
        else { pauseAllExcept('yt'); cPlayer.playVideo(); }
      }catch(_){}
    }

    function createCarouselPlayer(){
      cPlayer = new YT.Player('yt-carousel-player', {
        videoId: CAROUSEL_IDS[cIndex],
        playerVars: { rel:0, modestbranding:1, playsinline:1, controls:1 },
        events: {
          onReady: e => { try{ e.target.mute(); e.target.playVideo(); }catch(_){} updateTitleSoon(); },
          onStateChange: e => {
            if (e.data === YT.PlayerState.PLAYING) pauseAllExcept('yt');
            if (e.data === YT.PlayerState.ENDED) nextVideo();
            if (e.data === YT.PlayerState.PLAYING || e.data === YT.PlayerState.CUED) updateTitleSoon();
          }
        }
      });
      window._ytCarouselPlayerInstance = cPlayer; // registro global
      buildThumbs(); highlight();

      // Botones
      document.getElementById("btnPrevVid").onclick = prevVideo;
      document.getElementById("btnNextVid").onclick = nextVideo;
      document.getElementById("btnPlayPauseVid").onclick = togglePlay;

      // Fullscreen
      (function setupFS(){
        const btn = document.getElementById('btnFs');
        const shell = document.querySelector('.video-shell');
        function toggleFs(){ if (document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.(); }
        function onFsChange(){ btn.textContent = document.fullscreenElement ? "‚§¢ Salir de pantalla completa" : "‚§¢ Pantalla completa"; }
        btn?.addEventListener('click', toggleFs);
        document.addEventListener('fullscreenchange', onFsChange);
      })();

      // Teclas
      window.addEventListener('keydown', (ev)=>{
        if (ev.target.tagName === 'INPUT' || ev.target.tagName === 'TEXTAREA') return;
        if (ev.key === 'ArrowLeft') prevVideo();
        if (ev.key === 'ArrowRight') nextVideo();
        if (ev.code === 'Space') { ev.preventDefault(); togglePlay(); }
      });
    }

    // Cargar la API de YouTube 1 sola vez
    (function loadYT(){
      if (window.YT && window.YT.Player) { createCarouselPlayer(); return; }
      const prev = window.onYouTubeIframeAPIReady;
      window.onYouTubeIframeAPIReady = function(){ if (typeof prev==='function') prev(); createCarouselPlayer(); };
      if (![...document.scripts].some(s => (s.src||'').includes('iframe_api'))) {
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.body.appendChild(tag);
      }
    })();

    /***************** 3) PLAYLIST VIP (pausa radio y videos) *****************/
    const BASE = "../musica/"; // ajusta si tu index est√° en Privado/
    const raw1 = [
      { title: "Tema 1", file: "tema1.mp3" },
      { title: "Tema 2", file: "tema2.mp3" },
      { title: "Tema 3", file: "tema3.mp3" }
      // agrega m√°s...
    ];
    const tracks1 = raw1.map(t => ({ title: t.title, src: BASE + encodeURIComponent(t.file) }));

    const A1 = {
      audio:  document.getElementById('audio1'),
      list:   document.getElementById('list1'),
      prev:   document.getElementById('prev1'),
      play:   document.getElementById('play1'),
      next:   document.getElementById('next1'),
      status: document.getElementById('status1'),
      i: 0
    };

    function s1(msg, cls="color:#7CFC00"){ A1.status.style=cls; A1.status.textContent=msg; }

    function render1(){
      A1.list.innerHTML = "";
      tracks1.forEach((it, idx)=>{
        const li = document.createElement('li');
        const num = (idx+1).toString().padStart(2,'0');
        li.textContent = ${num} - ${it.title};
        li.style.padding="8px 10px"; li.style.borderRadius="8px"; li.style.cursor="pointer";
        li.style.background = idx===A1.i ? "rgba(0,191,255,.35)" : "transparent";
        li.onclick = () => { A1.i = idx; load1(true); };
        A1.list.appendChild(li);
      });
    }

    function load1(autoplay){
      A1.audio.src = tracks1[A1.i].src;
      render1();
      s1("Listo: "+tracks1[A1.i].title+" ‚úì");
      if (autoplay) { pauseAllExcept('playlist'); A1.audio.play().catch(()=>{}); }
    }

    A1.prev.onclick = ()=>{ A1.i = (A1.i - 1 + tracks1.length) % tracks1.length; load1(true); };
    A1.next.onclick = ()=>{ A1.i = (A1.i + 1) % tracks1.length; load1(true); };
    A1.play.onclick = ()=>{ if (A1.audio.paused) { pauseAllExcept('playlist'); A1.audio.play().catch(()=>{}); } else A1.audio.pause(); };
    A1.audio.addEventListener('ended', ()=>{ A1.i = (A1.i + 1) % tracks1.length; load1(true); });
    A1.audio.addEventListener('play', ()=> pauseAllExcept('playlist'));
    A1.audio.addEventListener('error', ()=> s1("‚ö† No se pudo cargar: "+decodeURIComponent(tracks1[A1.i].src)+" (¬øruta/nombre?)","color:#ffd166"));

    render1();
    // No auto-play al cargar: el usuario decide
  </script>
</body>
</html>
