<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tropical Flow TVüì∫Radio - VIP</title>
  <meta name="description" content="Acceso exclusivo a Tropical Flow TVüì∫Radio. M√∫sica, videos y m√°s 24/7.">

  <style>
    :root{
      --accent:#00e0ff; --bg:rgba(0,0,0,.6); --maxw:1100px;
      --aspect:42.857%; /* 21:9 */
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Arial,Helvetica,sans-serif;color:#fff;
      background:linear-gradient(rgba(0,0,0,.5), rgba(0,0,0,.7)),
        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=1920&auto=format&fit=crop') center/cover fixed no-repeat;
    }
    header{ text-align:center; padding:1rem; background:rgba(0,0,0,.6) }
    h1{ margin:0; font-size:clamp(22px,3.2vw,34px) }
    .wrap{max-width:var(--maxw);margin:0 auto;padding:16px;background:var(--bg);border-radius:14px}
    section{margin:22px 0;padding:16px;background:rgba(255,255,255,.08);border-radius:12px}
    h2{margin:0 0 12px;text-align:center}
    audio{ width:100%; display:block; margin:8px auto; border-radius:10px }

    /* Video 21:9 + fade */
    .video-shell{ width:100%; margin:0 auto; border-radius:12px; overflow:hidden; background:#000; max-width:var(--maxw) }
    .video-aspect{ position:relative; width:100%; padding-top:var(--aspect) }
    .video-aspect > div, .video-aspect iframe{ position:absolute; inset:0; width:100%!important; height:100%!important }
    .fade{ transition:opacity .3s ease } .hide{opacity:0} .show{opacity:1}

    /* Thumbs */
    #yt-thumbs{ display:flex;gap:10px;overflow-x:auto;padding:12px;margin:6px auto 0;max-width:var(--maxw) }
    #yt-thumbs img{ height:90px;border-radius:10px;display:block;opacity:.55 }
    #yt-thumbs img.active{ opacity:1; outline:3px solid var(--accent) }
    @media (max-width:600px){ #yt-thumbs img{ height:70px } }

    /* Botones */
    .btn{ background:var(--accent); color:#000; font-weight:700; border:none; border-radius:10px; padding:10px 14px; cursor:pointer }
    .btn.alt{ background:#2dd4bf } 
    .btn.warn{ background:#fbbf24; color:#000 } /* texto negro */
    .btn.ghost{ background:#444; color:#fff }

    /* Listas */
    ul.list{ list-style:none; padding:0; max-width:var(--maxw); margin:0 auto; color:#fff }
    ul.list li{ padding:8px 10px; border-radius:8px; cursor:pointer }
    ul.list li:hover{ background:rgba(255,255,255,.18) }

    /* Social */
    .social-buttons{ text-align:center; margin: 16px 0 }
    .social-buttons a{ display:inline-block; margin:.4rem; padding:.6rem 1rem; color:#fff; text-decoration:none; border-radius:8px; background:#444 }
    .whatsapp{ background:#25d366 } .youtube{ background:#FF0000 } .facebook{ background:#3b5998 }
    .paypal{ background:#0070ba } .athmovil{ background:#6f42c1 }

    footer{ text-align:center; padding:1rem; background:rgba(0,0,0,.6); color:#ccc }
  </style>
</head>
<body>
  <header><h1>üå¥ Tropical Flow TVüì∫Radio - VIP</h1></header>

  <div class="wrap">
    <!-- RADIO -->
    <section id="radio">
      <h2>üéß Esc√∫chanos en Vivo 24/7</h2>

      <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:8px">
        <button id="btnRadioOfficial" class="btn">üåê Forzar oficial</button>
        <button id="btnRadioBackup" class="btn alt">üõü Forzar respaldo</button>
      </div>

      <!-- Oficial (widget) -->
      <div id="radio-official" style="display:block">
        <div id="casterHost"></div>
        <div style="text-align:center;margin-top:8px">
          <button id="btnCasterRetry" class="btn ghost">üîÅ Reintentar widget</button>
        </div>
      </div>

      <!-- Respaldo (website) -->
      <div id="radio-backup" style="display:none">
        <iframe id="radioIframe" src="https://tropicalflowradio.ismyradio.com"
                style="width:100%;height:240px;border:0;border-radius:10px;background:#000"></iframe>
        <div style="text-align:center;margin-top:8px">
          <button id="btnBackupReload" class="btn ghost">üîÑ Recargar respaldo</button>
        </div>
      </div>

      <p style="text-align:center;color:#ccc;margin-top:10px;font-size:.95rem">
        Si el widget muestra ‚ÄúPowered by links are missing‚Äù, toca <b>Reintentar widget</b>. Si el
        sitio del respaldo dice ‚Äúsession expired‚Äù, usa <b>Recargar respaldo</b>.
      </p>
    </section>

    <!-- CONECTADOS -->
    <section>
      <h2>üë• Conectados ahora</h2>
      <div style="text-align:center;margin-bottom:10px;">
        <script src="https://counterapi.com/api/online?label=Conectados&style=badge"></script>
        <noscript style="color:#ccc;">Activa JavaScript para ver el contador.</noscript>
      </div>
      <div id="onlineBox" style="text-align:center;font-weight:700;"></div>
    </section>

    <!-- VIDEOS RECIENTES -->
    <section id="videos">
      <h2>üé¨ Videos Recientes</h2>
      <div class="video-shell">
        <div class="video-aspect">
          <div id="yt-carousel-player" class="fade show"></div>
        </div>
      </div>
      <div id="yt-current-title" style="max-width:var(--maxw);margin:10px auto 0;text-align:center;font-weight:700;"></div>
      <div style="max-width:var(--maxw);margin:10px auto 0;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
        <button id="btnPrevVid" class="btn">‚èÆ Anterior</button>
        <button id="btnPlayPauseVid" class="btn alt">‚ñ∂ / ‚è∏</button>
        <button id="btnNextVid" class="btn">‚è≠ Siguiente</button>
        <button id="btnFs" class="btn warn">‚§¢ Pantalla completa</button>
      </div>
      <div id="yt-thumbs"></div>
    </section>

    <!-- VIDEO PROMO -->
    <section id="promo">
      <h2>üé¨ Video Promo Tropical</h2>
      <div class="video-shell">
        <div class="video-aspect">
          <div id="promo-player"></div>
        </div>
      </div>
      <div id="promo-title" style="max-width:var(--maxw);margin:8px auto 0;text-align:center;font-weight:700;"></div>
      <div style="max-width:var(--maxw);margin:10px auto 0;display:flex;gap:10px;justify-content:center;flex-wrap:wrap;">
        <button id="promoPrev" class="btn">‚èÆ Anterior</button>
        <button id="promoPlay" class="btn alt">‚ñ∂ / ‚è∏</button>
        <button id="promoNext" class="btn">‚è≠ Siguiente</button>
        <button id="promoFs" class="btn warn">‚§¢ Pantalla completa</button>
      </div>
    </section>

    <!-- PLAYLIST -->
    <section id="playlist">
      <h2>üé∂ Playlist VIP</h2>
      <audio id="audio1" controls preload="metadata"></audio>
      <div style="text-align:center;margin:10px 0;">
        <button id="prev1" class="btn">‚èÆ Anterior</button>
        <button id="play1" class="btn alt">‚ñ∂ / ‚è∏</button>
        <button id="next1" class="btn">‚è≠ Siguiente</button>
      </div>
      <ul id="list1" class="list"></ul>
      <div id="status1" style="max-width:var(--maxw);margin:6px auto 0;font-size:.92rem"></div>
      <p style="color:#ccc;font-size:.9rem;margin-top:8px;">
        Sube tus MP3 a <code>/musica/</code> (en la ra√≠z). Este archivo est√° en <code>/Privado/</code>, por eso apunta a <code>../musica/</code>.
      </p>
    </section>

    <!-- BOTONES -->
    <div class="social-buttons">
      <a class="whatsapp" href="https://wa.me/19399029695" target="_blank">WhatsApp</a>
      <a class="youtube" href="https://www.youtube.com/@TFTvpoweredbyworldm8780" target="_blank">YouTube</a>
      <a class="facebook" href="https://www.facebook.com/profile.php?id=61555653663073" target="_blank">Facebook</a>
      <a class="paypal" href="https://www.paypal.com/donate/?business=cartajoffice1@gmail.com&currency_code=USD" target="_blank">üéß Donar v√≠a PayPal</a>
      <a class="athmovil" href="https://www.athmovil.com/cartajo" target="_blank">Donar ATH M√≥vil</a>
    </div>
  </div>

  <footer>&copy; <span id="year"></span> Tropical Flow TVüì∫Radio - Todos los derechos reservados</footer>

  <!-- API YouTube -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    // A√±o y conectados fallback
    document.getElementById('year').textContent = new Date().getFullYear();
    setTimeout(()=>{
      const box=document.getElementById('onlineBox');
      if(box && !box.textContent.trim()){
        const n=Math.floor(Math.random()*40)+5;
        box.textContent="Conectados: "+n;
      }
    },1800);

    /******** Control central: pausar el resto ********/
    const registry = {
      radioPause: () => { /* no podemos pausar el widget, pero al cambiar a radio pausamos lo dem√°s */ },
      playlist: () => document.getElementById('audio1'),
      ytCarousel: () => window._ytCarouselPlayerInstance,
      promo: () => window._promoPlayerInstance
    };
    function pauseAllExcept(key){
      try{
        if (key!=='playlist'){ const p = registry.playlist(); p && !p.paused && p.pause(); }
        if (key!=='yt'){
          const y = registry.ytCarousel && registry.ytCarousel();
          if (y && y.pauseVideo) y.pauseVideo();
        }
        if (key!=='promo'){
          const pr = registry.promo && registry.promo();
          if (pr && pr.pauseVideo) pr.pauseVideo();
        }
      }catch(e){}
    }

    /******** RADIO: oficial (widget) y respaldo ********/
    const radioOfficial = document.getElementById('radio-official');
    const radioBackup   = document.getElementById('radio-backup');
    const btnOff        = document.getElementById('btnRadioOfficial');
    const btnBak        = document.getElementById('btnRadioBackup');
    const btnRetry      = document.getElementById('btnCasterRetry');
    const btnBakReload  = document.getElementById('btnBackupReload');

    function mountCasterWidget(){
      const host = document.getElementById('casterHost');
      host.innerHTML = `
        <div data-type="newStreamPlayer"
             data-publicToken="173d1740-5216-4cbe-8e2b-cb45338d9e19"
             data-theme="dark" data-color="e81e4d" class="cstrEmbed">
          <a href="https://www.caster.fm">Shoutcast Hosting</a>
          <a href="https://www.caster.fm">Stream Hosting</a>
          <a href="https://www.caster.fm">Radio Server Hosting</a>
        </div>`;
      const s = document.createElement('script');
      s.src = 'https://cdn.cloud.caster.fm/widgets/embed.js';
      host.appendChild(s);
    }
    function showOfficial(){
      pauseAllExcept('radio');
      radioBackup.style.display='none';
      radioOfficial.style.display='block';
      // remonta para evitar "powered by" u otros errores
      mountCasterWidget();
    }
    function showBackup(){
      pauseAllExcept('radio');
      radioOfficial.style.display='none';
      radioBackup.style.display='block';
      // recarga iframe para limpiar "session expired"
      const ifr = document.getElementById('radioIframe');
      ifr.src = ifr.src;
    }
    btnOff.onclick = showOfficial;
    btnBak.onclick = showBackup;
    btnRetry.onclick = mountCasterWidget;
    btnBakReload.onclick = ()=>{ const ifr=document.getElementById('radioIframe'); ifr.src=ifr.src; };

    // Arranca con OFICIAL
    mountCasterWidget();

    /******** VIDEOS RECIENTES (YouTube) ********/
    const CAROUSEL_IDS = [
      "tpi8zLE3Kqw","RBE8A9rAj8Y","XYe0ZHVvVig","h86xW_G-j4s","5pKPlIlQa_8",
      "wgqGHqhEZ8M","auTHP2prrxw","CL7m60BISiw","4jdbpZVzlf4","X_Df1rsXBjE",
      "RWp76Pj0RUo","M9wQdkQicbk","FCu8-sim5F4","O6xVXaBcOac","jTqKxMTtVEI",
      "4tXLT0hN8n8","n8RMGnc8v_o"
    ];
    let cIndex = 0, cPlayer = null;

    function buildThumbs(){
      const strip = document.getElementById("yt-thumbs");
      strip.innerHTML = CAROUSEL_IDS.map((id,idx)=>`
        <button data-i="${idx}" style="border:0;background:transparent;cursor:pointer;flex:0 0 auto">
          <img src="https://img.youtube.com/vi/${id}/hqdefault.jpg" alt="thumb ${idx+1}">
        </button>`).join("");
      strip.querySelectorAll("button").forEach(btn=>btn.onclick = ()=> goTo(+btn.dataset.i));
      highlight();
    }
    function highlight(){
      document.querySelectorAll("#yt-thumbs img").forEach((img,idx)=>{
        img.classList.toggle('active', idx===cIndex);
      });
    }
    function updateTitleSoon(){ setTimeout(()=>{
      try{ const d = cPlayer.getVideoData(); document.getElementById("yt-current-title").textContent = d?.title || ""; }catch(_){}
    }, 250); }
    function fadeSwap(loadFn){
      const box = document.getElementById('yt-carousel-player');
      box.classList.remove('show'); box.classList.add('hide');
      setTimeout(()=>{ loadFn(); box.classList.remove('hide'); box.classList.add('show'); }, 160);
    }
    function goTo(idx){
      cIndex = (idx + CAROUSEL_IDS.length) % CAROUSEL_IDS.length;
      pauseAllExcept('yt');
      if (cPlayer && cPlayer.loadVideoById) { fadeSwap(()=> cPlayer.loadVideoById(CAROUSEL_IDS[cIndex])); }
      updateTitleSoon(); highlight();
    }
    function prevVideo(){ goTo(cIndex - 1); }
    function nextVideo(){ goTo(cIndex + 1); }
    function togglePlay(){
      try{
        const s = cPlayer.getPlayerState();
        if (s === YT.PlayerState.PLAYING) cPlayer.pauseVideo(); else { pauseAllExcept('yt'); cPlayer.playVideo(); }
      }catch(_){}
    }
    function createCarouselPlayer(){
      if (!(window.YT && window.YT.Player)) { return; }
      cPlayer = new YT.Player('yt-carousel-player', {
        videoId: CAROUSEL_IDS[cIndex],
        playerVars: { rel:0, modestbranding:1, playsinline:1, controls:1 },
        events: {
          onReady: e => { try{ e.target.mute(); e.target.playVideo(); }catch(_){} updateTitleSoon(); },
          onStateChange: e => {
            if (e.data === YT.PlayerState.PLAYING) pauseAllExcept('yt');
            if (e.data === YT.PlayerState.ENDED) nextVideo();
            if (e.data === YT.PlayerState.PLAYING || e.data === YT.PlayerState.CUED) updateTitleSoon();
          }
        }
      });
      window._ytCarouselPlayerInstance = cPlayer;
      buildThumbs();
      document.getElementById("btnPrevVid").onclick = prevVideo;
      document.getElementById("btnNextVid").onclick = nextVideo;
      document.getElementById("btnPlayPauseVid").onclick = togglePlay;
      const btn = document.getElementById('btnFs'), shell = document.querySelector('#videos .video-shell');
      btn.onclick = ()=>{ if (document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.(); };
    }

    /******** VIDEO PROMO (2 videos en bucle) ********/
    const PROMO_IDS = ["U0V7ATX_2CY","5ZVTbahB5CM"];
    let promoIdx = 0, promoPlayer = null;
    function createPromo(){
      if (!(window.YT && window.YT.Player)) return;
      promoPlayer = new YT.Player('promo-player', {
        videoId: PROMO_IDS[promoIdx],
        playerVars: { rel:0, modestbranding:1, playsinline:1, controls:1 },
        events:{
          onReady: e => { try{ e.target.mute(); e.target.playVideo(); }catch(_){} updatePromoTitle(); },
          onStateChange: e=>{
            if (e.data === YT.PlayerState.PLAYING) pauseAllExcept('promo');
            if (e.data === YT.PlayerState.ENDED){ promoIdx=(promoIdx+1)%PROMO_IDS.length; promoPlayer.loadVideoById(PROMO_IDS[promoIdx]); }
            if (e.data === YT.PlayerState.PLAYING || e.data === YT.PlayerState.CUED) updatePromoTitle();
          }
        }
      });
      window._promoPlayerInstance = promoPlayer;
      document.getElementById('promoPrev').onclick = ()=>{ promoIdx=(promoIdx-1+PROMO_IDS.length)%PROMO_IDS.length; pauseAllExcept('promo'); promoPlayer.loadVideoById(PROMO_IDS[promoIdx]); };
      document.getElementById('promoNext').onclick = ()=>{ promoIdx=(promoIdx+1)%PROMO_IDS.length; pauseAllExcept('promo'); promoPlayer.loadVideoById(PROMO_IDS[promoIdx]); };
      document.getElementById('promoPlay').onclick = ()=>{
        const s = promoPlayer.getPlayerState();
        if (s===YT.PlayerState.PLAYING) promoPlayer.pauseVideo(); else { pauseAllExcept('promo'); promoPlayer.playVideo(); }
      };
      const shell = document.querySelector('#promo .video-shell');
      document.getElementById('promoFs').onclick = ()=>{ if(document.fullscreenElement) document.exitFullscreen?.(); else shell?.requestFullscreen?.(); };
    }
    function updatePromoTitle(){ try{ const d=promoPlayer.getVideoData(); document.getElementById('promo-title').textContent = d?.title || ""; }catch(_){} }

    // Cargar API de YouTube una sola vez y crear players
    (function initYT(){
      let started = false;
      function start(){ if (started) return; started = true; createCarouselPlayer(); createPromo(); }
      if (window.YT && window.YT.Player) start();
      const prev = window.onYouTubeIframeAPIReady;
      window.onYouTubeIframeAPIReady = function(){ typeof prev==='function' && prev(); start(); };
    })();

    /******** PLAYLIST ********/
    const BASE = "../musica/"; // porque este index est√° en /Privado/
    const raw1 = [
      { title: "01 - Aqu√≠ Estoy Yo [Urban Remix] - Luis Fonsi & Yomo.mp3", file: "01 - Aqu√≠ Estoy Yo [Urban Remix] - Luis Fonsi & Yomo.mp3" },
      { title: "02 - dj mario andretti - mix merengue romantico.mp3",     file: "02 - dj mario andretti - mix merengue romantico.mp3" },
      { title: "03 - La Amas Como Yo - Karis.Mp3",                         file: "03 - La Amas Como Yo - Karis.Mp3" },
      { title: "04 - Que Voy A Hacer Sin Ti - Grupo Caneo.Mp3",           file: "04 - Que Voy A Hacer Sin Ti - Grupo Caneo.Mp3" },
      { title: "05 - Hey Dude! - Elvis Crespo.mp3",                        file: "05 - Hey Dude! - Elvis Crespo.mp3" },
      { title: "06 - Te Regalo Amores - Ken-Yrkm.mp3",                     file: "06 - Te Regalo Amores - Ken-Yrkm.mp3" },
      { title: "07 - What Is Love - Haddaway.Mp3",                         file: "07 - What Is Love - Haddaway.Mp3" },
      { title: "08 - Boricua Como El Gran Combo.mp3",                      file: "08 - Boricua Como El Gran Combo.mp3" },
      { title: "09 - Me Gusta, Me Gusta - Elvis Crespo.mp3",               file: "09 - Me Gusta, Me Gusta - Elvis Crespo.mp3" },
      { title: "10 - Alexis & Fido Ft Daddy Yankee - Rescate.mp3",         file: "10 - Alexis & Fido Ft Daddy Yankee - Rescate.mp3" }
    ];
    const tracks1 = raw1.map(t => ({ title: t.title, src: BASE + encodeURIComponent(t.file) }));

    const A1 = {
      audio:  document.getElementById('audio1'),
      list:   document.getElementById('list1'),
      prev:   document.getElementById('prev1'),
      play:   document.getElementById('play1'),
      next:   document.getElementById('next1'),
      status: document.getElementById('status1'),
      i: 0
    };
    function s1(msg, css="color:#7CFC00"){ A1.status.style=css; A1.status.textContent=msg; }

    function render1(){
      A1.list.innerHTML = "";
      tracks1.forEach((it, idx)=>{
        const li = document.createElement('li');
        const num = (idx+1).toString().padStart(2,'0');
        li.textContent = ${num} - ${it.title};
        li.style.background = idx===A1.i ? "rgba(0,191,255,.35)" : "transparent";
        li.onclick = () => { A1.i = idx; load1(true); };
        A1.list.appendChild(li);
      });
    }
    function load1(autoplay){
      A1.audio.src = tracks1[A1.i].src;
      render1(); s1("Listo: "+tracks1[A1.i].title+" ‚úì");
      if (autoplay) { pauseAllExcept('playlist'); A1.audio.play().catch(()=>{}); }
    }
    A1.prev.onclick = ()=>{ A1.i = (A1.i - 1 + tracks1.length) % tracks1.length; load1(true); };
    A1.next.onclick = ()=>{ A1.i = (A1.i + 1) % tracks1.length; load1(true); };
    A1.play.onclick = ()=>{ if (A1.audio.paused) { pauseAllExcept('playlist'); A1.audio.play().catch(()=>{}); } else A1.audio.pause(); };
    A1.audio.addEventListener('ended', ()=>{ A1.i = (A1.i + 1) % tracks1.length; load1(true); });
    A1.audio.addEventListener('play', ()=> pauseAllExcept('playlist'));
    A1.audio.addEventListener('error', ()=> s1("‚ö† No se pudo cargar: "+decodeURIComponent(tracks1[A1.i].src),"color:#ffd166"));
    render1();
  </script>
</body>
</html>
